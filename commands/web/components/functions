#!/bin/bash
#ddev-generated - Do not modify this file; your modifications will be overwritten.

# Check if gum is installed
function check_gum() {
    if ! command -v gum &>/dev/null; then
        echo -e "\n${txtred}gum is not installed.${txtrst}"
        echo -e "${txtgrn}Installing gum...${txtrst}"
        mkdir -p /etc/apt/keyrings
        curl -fsSL https://repo.charm.sh/apt/gpg.key | gpg --dearmor -o /etc/apt/keyrings/charm.gpg
        echo "deb [signed-by=/etc/apt/keyrings/charm.gpg] https://repo.charm.sh/apt/ * *" | tee /etc/apt/sources.list.d/charm.list
        apt-get update && apt-get install -y gum
    fi
}

# Check if mysql is installed
function check_mysql() {
    if ! command -v mysql &>/dev/null; then
        echo -e "\n${txtred}mysql command not found.${txtrst}"
        echo -e "${txtred}Please ensure MySQL client is installed.${txtrst}"
        exit 1
    fi
}

# Generate grunt-local-themes.js content
function generate_grunt_config() {
    local theme_configs="$1"
    cat > "${THEMES_CONFIG_FILE}" << 'HEADER'
'use strict';

// Generated by ddev-grunt-browsersync

module.exports = {
HEADER
    echo "$theme_configs" >> "${THEMES_CONFIG_FILE}"
    cat >> "${THEMES_CONFIG_FILE}" << 'FOOTER'
};
FOOTER
}

# Get theme path from user
function get_theme_path() {
    local theme_code="$1"
    local default_path="app/design/frontend/${theme_code}"
    gum input --cursor.foreground "#CCC" \
        --prompt "Theme path (${theme_code}): " \
        --prompt.foreground="#84CC16" \
        --placeholder "app/design/frontend/Vendor/theme" \
        --value "${default_path}"
}
